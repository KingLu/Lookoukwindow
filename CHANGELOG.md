# 更新日志 (Changelog)

所有项目的显著更改都将记录在此文件中。

## [v0.5.0] - 2025-11-29

### 重大变更 (Breaking Changes)

- **相册架构重构**:
  - 引入 "照片库 (Library) + 逻辑相册" 的新架构。所有照片统一存储在 `data/library` 大池子中，相册仅作为逻辑分组（仅存储照片ID引用）。
  - **自动迁移**: 系统启动时会自动将旧版的文件夹式相册迁移到新的库结构中，原有照片不会丢失。
  - **去重机制**: 上传时通过 SHA-256 哈希自动检测重复文件，避免冗余存储。

### 新增功能 (Features)

- **照片库管理 (Photo Library)**:
  - 新增 `/admin/library` 独立管理页面。
  - 支持拖拽上传、上传进度条显示、按备注/地点搜索。
  - **照片编辑**: 支持在线 **向左/向右旋转** 照片，修改拍摄时间、地点名称和备注。
  - **Web 优化图**: 自动生成 1920px 宽度的 Web 优化版图片，提升加载速度和轮播性能。

- **相册管理增强**:
  - 新增 `/admin/albums` 独立相册管理页面。
  - **照片选择器**: 向相册添加照片时，支持从库中选择，并增加了 **全选** 功能，方便批量操作。
  - 一个照片可以加入多个相册，无需复制文件。

- **展示体验升级**:
  - **切换特效**: 首页播放器新增 4 种随机切换动画（淡入淡出、滑动、缩放、上推），视觉效果更生动。
  - **智能预加载**: 优化了下一张图片的预加载逻辑，减少卡顿。
  - **缓存自动刷新**: 编辑或旋转照片后，首页和管理页会自动刷新缩略图缓存，立即显示最新状态。

### 修复 (Fixes)

- 修复了旧数据迁移时的参数调用错误。
- 修复了旋转照片后浏览器缓存导致缩略图不更新的问题。
- 优化了相册加载性能，移除了导致超时的实时逆地理编码操作（改为上传时处理）。

## [v0.4.0] - 2025-11-28

### 新增功能 (Features)

- **节能休眠模式 (Sleep Mode)**:
  - **全屏夜间时钟**: 休眠时显示黑底大字时钟，包含秒、公历/农历日期、星期。
  - **深度节能**: 休眠期间自动销毁 YouTube 播放器、暂停所有轮播动画和网络请求，显著降低功耗。
  - **防烧屏保护**: 时钟位置每 5 分钟随机偏移。
  - **智能唤醒**: 休眠结束自动恢复直播和数据更新。

- **动态配置系统**:
  - 设置页面新增节能模式控制面板（开关及起止时间）。
  - 前端实现配置热更新，修改设置后无需刷新页面即可生效。

## [v0.3.0] - 2025-11-28

### 新增功能 (Features)

- **金融信息看板**:
  - 首页底部新增金融数据滚动展示栏，支持全球主要指数（如上证、纳斯达克、BTC等）的实时行情。
  - 新增个股详情轮播功能，支持显示个股实时价格、涨跌幅。
  - **个股双图表展示**: 
    - 左侧展示当日分时走势图（5分钟级）。
    - 右侧展示近1年日K线走势图。
    - 均支持在设置页面自定义指数列表和自选股列表。

- **智能生活信息**:
  - **农历与节气**: 首页左上角新增农历日期、干支纪年（如乙巳年）、生肖显示。
  - **实时天气与预报**: 
    - 集成 Open-Meteo API，显示实时温度和天气图标。
    - 新增未来 2、4、6 小时的天气预报。
    - 强制对齐北京时间，确保预报准确性。

- **设置增强**:
  - 新增 **金融数据设置** 模块：
    - 支持配置指数列表和自选股列表。
    - 支持自定义 **指数轮播速度** (Ticker Speed)。
    - 支持自定义 **个股切换间隔** (Stock Switch Interval)。
  - 设置页面底部增加悬浮保存栏，统一保存所有设置，提升用户体验。

### 优化 (Optimizations)

- **首页布局重构**:
  - 采用 "左侧多功能 + 右侧相册" 的布局结构。
  - 左侧分为：顶部生活信息栏、中部直播窗口（保持16:9）、底部金融看板。
  - 优化了日期时间的显示逻辑，日期在上，时间在下，并补全了秒显示 (HH:MM:SS)。
  
- **技术栈更新**:
  - 引入 `yfinance` 库用于获取金融数据。
  - 引入 `lunar-javascript` 用于前端农历转换。
  - 引入 `Chart.js` 用于绘制股票走势图。

## [v0.2.0] - 2023-12-XX (示例)

- 基础功能版本，包含 NASA 直播、本地相册轮播、基础设置等功能。
